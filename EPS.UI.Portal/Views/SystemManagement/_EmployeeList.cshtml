@using EPS.UI.Portal.Models
@{
    ViewBag.Title = "EmployeeList";
    List<EmployeeModel> employeeList = ViewBag.Model as List<EmployeeModel>;
}

@*table-body*@
<div class="box-body">
    <table id="example2" class="table table-bordered table-hover">
        <thead>
            <tr>
                
                <th>人员编号</th>
                <th>人员名称</th>
                <th>小组编号</th>
                <th>小组名称</th>
                <th>部门编号</th>
                <th>部门名称</th>
                <th>公司编号</th>
                <th>公司名称</th>
                <th>备注</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var employee in employeeList)
            {
            <tr>

                <td>@employee.Number<input type="hidden" name="id" class="schemeId" value=@employee.Id /></td>
                <td>@employee.Name<input type="hidden" name="employeeId" value=@employee.Id /></td>
                <td>@employee.GroupId<input type="hidden" name="patrolRouteId" value=@employee.GroupId /></td>
                <td>@employee.GroupName</td>
                <td>@employee.DepartmentId</td>
                <td>@employee.DepartmentName</td>
                <td>@employee.CompanyId</td>
                <td>@employee.CompanyName</td>
                <td> </td>
                
                <td>
                    @Html.ActionLink("修改", "UpdateEmployee", "SystemManagement", new { employeeId = employee.Id }, new { @class = "btn btn-primary" })
                    <button class="btn btn-danger btn_Delete" id=@employee.Id value="删除">删除</button>
                </td>
            </tr>
            }
        </tbody>
    </table>
</div>

@*pagination*@
<div class="text-right">
    <div class="pagination">
        @{
            var pageModel = ViewBag.PageModel == null ? null : (PaginationModel)ViewBag.PageModel;
        }
        @Html.Partial("Pagination", pageModel)
    </div>
</div>

<script src="/wwwroot/lib/jquery/dist/jquery.js"></script>
<script>
    $(function () {
        //点击删除按钮
        $('.btn_Delete').click(function () {
            var employeeId = $(this).attr('id')
            console.log(employeeId)
            layer.alert('确定要删除吗', {
                //skin: 'layui-layer-molv',   //样式类名  自定义样式
                closeBtn: 1,                // 是否显示关闭按钮
                anim: 1,                    //动画类型
                btn: ['确定', '取消'],      //按钮
                icon: 3,                    // icon
                yes: function () {
                    layer.msg('按钮1')

                    $.ajax({
                        url: '/SystemManagement/DeleteEmployeeById',
                        type: 'post',
                        async: false,
                        data: { employeeId: employeeId },
                        success: function (result) {
                            if (!result.State) {
                                layer.alert("删除失败", { icon: 2 });
                            }
                            else {
                                setTimeout(function () {
                                    window.location = window.location.href;
                                }, 1);
                                layer.alert("删除成功", { icon: 1 });
                            }
                        }
                    })
                },
                btn2: function () {
                }
            });
        })
    });
</script>